<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Filter features of one SE based on their rowData — QFeatures-filtering-oneSE • DaparToolshed</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Filter features of one SE based on their rowData — QFeatures-filtering-oneSE"><meta property="og:description" content="The filterFeaturesOneSE methods enables users to filter features
based on a variable in their rowData. It is directly inspired of the
function filterFeature of the package QFeatures.
The first difference is that the filter only applies to one SummarizedExperiment
contained in the object rather than applying on all the SE.
This method generates a new SummarizedExperiment object which is added to the QFeatures object.
If the SE on which the filter applies is the last one of the object, then a new xxxx.
If it is not the last one, the new SE is added and all the further SE are deleted.
The features matching the
The filters can be provided as instances of class AnnotationFilter (see the package QFeatures)
or of class FunctionFilter (see below)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DaparToolshed</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/samWieczorek/DaparToolshed/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter features of one SE based on their rowData</h1>
    <small class="dont-index">Source: <a href="https://github.com/samWieczorek/DaparToolshed/blob/HEAD/R/DaparToolshed-filterFeaturesOneSE.R" class="external-link"><code>R/DaparToolshed-filterFeaturesOneSE.R</code></a></small>
    <div class="hidden name"><code>QFeatures-filtering-oneSE.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>filterFeaturesOneSE</code> methods enables users to filter features
based on a variable in their <code>rowData</code>. It is directly inspired of the
function <code>filterFeature</code> of the package <code>QFeatures</code>.
The first difference is that the filter only applies to one <code>SummarizedExperiment</code>
contained in the object rather than applying on all the SE.
This method generates a new <code>SummarizedExperiment</code> object which is added to the <code>QFeatures</code> object.
If the SE on which the filter applies is the last one of the object, then a new xxxx.
If it is not the last one, the new SE is added and all the further SE are deleted.
The features matching the
The filters can be provided as instances of class <code>AnnotationFilter</code> (see the package <code>QFeatures</code>)
or of class <code>FunctionFilter</code> (see below).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">FunctionFilter</span><span class="op">(</span><span class="va">name</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S4 method for QFeatures</span>
<span class="fu">filterFeaturesOneSE</span><span class="op">(</span><span class="va">object</span>, <span class="va">i</span>, name <span class="op">=</span> <span class="st">"newAssay"</span>, <span class="va">filters</span><span class="op">)</span>

<span class="co"># S4 method for SummarizedExperiment</span>
<span class="fu">filterFeaturesOneSE</span><span class="op">(</span><span class="va">object</span>, <span class="va">filters</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>name</dt>
<dd><p>A <code>character(1)</code> naming the new assay. Default is
<code>newAssay</code>. Note that the function will fail if there's
already an assay with <code>name</code>.</p></dd>
<dt>object</dt>
<dd><p>An instance of class <a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">QFeatures</a> or SummarizedExperiment.</p></dd>
<dt>i</dt>
<dd><p>The index or name of the assay which features will be
filtered the create the new assay.</p></dd>
<dt>filters</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> containing instances of class AnnotationFilter or
FunctionFilter</p></dd>
<dt>params</dt>
<dd><p><code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> or <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code> parameters for the
<code>name</code> function.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A filtered <code>QFeature</code> object</p>
    </div>
    <div id="function-filters">
    <h2>Function filters</h2>
    


<p>The function filters are filters as defined in the
DaparToolshed package. Each filter is defined by a name (which is the name of a function)
and a list which contains the parameters passed to the function.
Those filters can be created with the <code>FunctionFilter</code> constructor.</p>
<p>Those functions are divided into two main categories:</p><ul><li><p>the one that filter on one rowData feature,</p></li>
<li><p>the one based on a two-dimensional information such as the adjacency matrix</p></li>
</ul><p>for the first category, all filters of class AnnotationFilter can be used as they
are used in <code>QFeatures</code></p>
<p>For the second category, the package <code>DaparToolshed</code> provides filter functions based either
on the adjacency matrix:</p><ul><li><p></p></li>
<li><p></p></li>
<li><p></p></li>
</ul><p>Or based on the quantitative metadata (identification):</p><ul><li><p></p></li>
<li><p></p></li>
<li><p></p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Samuel Wieczorek</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## ----------------------------------------</span></span>
<span class="r-in"><span class="co">## Creating function filters</span></span>
<span class="r-in"><span class="co">## ----------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'FUN'</span>, </span>
<span class="r-in">               param1 <span class="op">=</span> <span class="st">'value_of_param1'</span>, </span>
<span class="r-in">               param2 <span class="op">=</span> <span class="st">'value_of_param2'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class "FunctionFilter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "name":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "FUN"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "params":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $param1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "value_of_param1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $param2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "value_of_param2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in">               </span>
<span class="r-in"><span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'qMetadataWholeLine'</span>, </span>
<span class="r-in">               cmd <span class="op">=</span> <span class="st">'delete'</span>, </span>
<span class="r-in">               pattern <span class="op">=</span> <span class="st">'imputed POV'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class "FunctionFilter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "name":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "qMetadataWholeLine"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "params":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cmd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "delete"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pattern</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "imputed POV"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in">               </span>
<span class="r-in"><span class="co">## ----------------------------------------------------------------</span></span>
<span class="r-in"><span class="co">## Filter the last assay to keep only specific peptides. This filter </span></span>
<span class="r-in"><span class="co">## only applies on peptide dataset.</span></span>
<span class="r-in"><span class="co">## ----------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">spec.filter</span> <span class="op">&lt;-</span> <span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'specPeptides'</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## using a user-defined character filter</span></span>
<span class="r-in"><span class="fu">filterFeaturesOneSE</span><span class="op">(</span><span class="va">feat1</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'specPeptides'</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures containing 1 assays:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] psms: SummarizedExperiment with 10 rows and 2 columns </span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ----------------------------------------------------------------</span></span>
<span class="r-in"><span class="co">## Filter the last assay to keep only specific peptides and topn peptides. The</span></span>
<span class="r-in"><span class="co">## two filters are run sequentially.</span></span>
<span class="r-in"><span class="co">## ----------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">lst.filters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'specPeptides'</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">lst.filters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">lst.filters</span>, </span>
<span class="r-in">                      <span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'topnPeptides'</span>, </span>
<span class="r-in">                      fun <span class="op">=</span> <span class="st">'rowSums'</span>, </span>
<span class="r-in">                      top <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">filterFeaturesOneSE</span><span class="op">(</span><span class="va">feat1</span>, <span class="va">lst.filters</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures containing 1 assays:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] psms: SummarizedExperiment with 10 rows and 2 columns </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ----------------------------------------------------------------</span></span>
<span class="r-in"><span class="co">## Filter the last assay to delete peptides where, in at least one condition,</span></span>
<span class="r-in"><span class="co">## there is less than 80% of samples marked as 'imputed POV'</span></span>
<span class="r-in"><span class="co">## ----------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">filter</span> <span class="op">&lt;-</span> <span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'qMetadataOnConditions'</span>, </span>
<span class="r-in">                        cmd <span class="op">=</span> <span class="st">'delete'</span>,</span>
<span class="r-in">                        mode <span class="op">=</span> <span class="st">'AtLeastOneCond'</span>,</span>
<span class="r-in">                        pattern <span class="op">=</span> <span class="st">'imputed POV'</span>,</span>
<span class="r-in">                        conds <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">ft</span><span class="op">)</span><span class="op">$</span><span class="va">Condition</span>,</span>
<span class="r-in">                        percent <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span class="r-in">                        th <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span class="r-in">                        operator <span class="op">=</span> <span class="st">'&lt;'</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'colData': object 'ft' not found</span>
<span class="r-in">                        </span>
<span class="r-in"> <span class="fu">filterFeaturesOneSE</span><span class="op">(</span><span class="va">feat1</span>, <span class="va">filter</span><span class="op">)</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures containing 1 assays:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] psms: SummarizedExperiment with 10 rows and 2 columns </span>
<span class="r-in"> </span>
<span class="r-in">                       </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Samuel Wieczorek, Thomas Burger.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

