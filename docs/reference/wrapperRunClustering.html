<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run a clustering pipeline of protein/peptide abundance profiles. — wrapperRunClustering • DaparToolshed</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run a clustering pipeline of protein/peptide abundance profiles. — wrapperRunClustering"><meta property="og:description" content="This function does all of the steps necessary to obtain a
clustering model and its graph from average abundances of proteins/peptides.
It is possible to carry out either a kmeans model or an affinity
propagation model. See details for exact steps."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DaparToolshed</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/samWieczorek/DaparToolshed/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run a clustering pipeline of protein/peptide abundance profiles.</h1>
    <small class="dont-index">Source: <a href="https://github.com/samWieczorek/DaparToolshed/blob/HEAD/R/clustering.R" class="external-link"><code>R/clustering.R</code></a></small>
    <div class="hidden name"><code>wrapperRunClustering.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function does all of the steps necessary to obtain a
clustering model and its graph from average abundances of proteins/peptides.
It is possible to carry out either a kmeans model or an affinity
propagation model. See details for exact steps.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">wrapperRunClustering</span><span class="op">(</span>
  <span class="va">obj</span>,
  <span class="va">i</span>,
  <span class="va">clustering_method</span>,
  conditions_order <span class="op">=</span> <span class="cn">NULL</span>,
  k_clusters <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">adjusted_pvals</span>,
  ttl <span class="op">=</span> <span class="st">""</span>,
  subttl <span class="op">=</span> <span class="st">""</span>,
  FDR_thresholds <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>obj</dt>
<dd><p>QFeatures object.</p></dd>
<dt>i</dt>
<dd><p>xxxx</p></dd>
<dt>clustering_method</dt>
<dd><p>character string. Three possible values are "kmeans",
"affinityProp" and "affinityPropReduced. See the details section for more
explanation.</p></dd>
<dt>conditions_order</dt>
<dd><p>vector specifying the order of the Condition factor
levels in the phenotype data. Default value is NULL, which means that it is the
order of the condition present in the phenotype data of "obj" which is
taken to create the profiles.</p></dd>
<dt>k_clusters</dt>
<dd><p>integer or NULL. Number of clusters to run the kmeans
algorithm. If <code>clustering_method</code> is set to "kmeans" and this parameter is
set to NULL, then a kmeans model will be realized with an optimal number of
clusters <code>k</code> estimated by the Gap statistic method. Ignored for the Affinity
propagation model.</p></dd>
<dt>adjusted_pvals</dt>
<dd><p>vector of adjusted pvalues returned by the <code><a href="wrapperClassic1wayAnova.html">wrapperClassic1wayAnova()</a></code></p></dd>
<dt>ttl</dt>
<dd><p>the title for the final plot</p></dd>
<dt>subttl</dt>
<dd><p>the subtitle for the final plot</p></dd>
<dt>FDR_thresholds</dt>
<dd><p>vector containing the different threshold
values to be used to color the profiles according to their adjusted pvalue.
The default value (NULL) generates 4 thresholds: 0.001, 0.005, 0.01, 0.05.
Thus, there will be 5 intervals therefore 5 colors: the pvalues &lt;0.001,
those between 0.001 and 0.005, those between 0.005 and 0.01, those between
0.01 and 0.05, and those&gt; 0.05. The highest given value will be considered
as the threshold of insignificance, the profiles having a pvalue&gt; this
threshold value will then be colored in gray.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a list of 2 elements: "model" is the clustering model, "ggplot" is the ggplot
of profiles clustering.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The first step consists in averaging the abundances of
proteins/peptides according to the different conditions defined in the
phenotype data of the expressionSet / MSnSet. Then we standardize the data,
check the clusterability of the data and estimate a number of clusters using
the gap statistic method. This optimal k is used only in the case where we
ask to realize a kmeans model without specifying the desired number of
clusters (<code>clustering_method =" kmeans "</code> and <code>k_clusters = NULL</code>). We
advise however to specify a k for the kmeans, because the gap stat gives
the smallest possible k, whereas in biology a small number of clusters can
turn out to be uninformative. If you want to run a kmeans but you don't
know what number of clusters to give, you can let the pipeline run the
first time without specifying <code>k_clusters</code>, in order to view the profiles
the first time and choose by the following is a more appropriate value of
k. If it is assumed that the data can be structured with a large number of
clusters, it is recommended to use the affinity propagation model instead.
This method simultaneously considers all the data as exemplary potentials,
unlike hard clustering (kmeans) which initializes with a number k of points
taken at random. The "affinityProp" model will use a q parameter set to NA,
meaning that exemplar preferences are set to the median of non-Inf values
in the similarity matrix (set q to 0.5 will be the same). The
"affinityPropReduced" model will use a q set to 0, meaning that exemplar
preferences are set to the sample quantile with threshold 0 of non-Inf
values. This should lead to a smaller number of final clusters.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Tibshirani, R., Walther, G. and Hastie, T. (2001). Estimating the number of data clusters via the Gap statistic. <em>Journal of the Royal Statistical Society</em> B, 63, 411–423.</p>
<p>Frey, B. J. and Dueck, D. (2007) Clustering by passing messages between data points. <em>Science</em> 315, 972-976. DOI: <a href="https://science.sciencemag.org/content/315/5814/972" class="external-link">10.1126/science.1136800</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Hélène Borges</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">test_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="wrapperClassic1wayAnova.html">wrapperClassic1wayAnova</a></span><span class="op">(</span><span class="va">fibrose</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in wrapperClassic1wayAnova(fibrose):</span> object 'fibrose' not found</span>
<span class="r-in"><span class="va">test_clust_pipeline</span> <span class="op">&lt;-</span> <span class="fu">wrapperRunClustering</span><span class="op">(</span>obj <span class="op">=</span> <span class="va">fibrose</span>,</span>
<span class="r-in">                                 clustering_method <span class="op">=</span> <span class="st">"affinityPropReduced"</span>, adjusted_pvals <span class="op">=</span> <span class="va">test_anova</span><span class="op">$</span><span class="va">P_Value</span><span class="op">$</span><span class="va">anova1way</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in wrapperRunClustering(obj = fibrose, clustering_method = "affinityPropReduced",     adjusted_pvals = test_anova$P_Value$anova1way):</span> object 'fibrose' not found</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Samuel Wieczorek, Thomas Burger.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

